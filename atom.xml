<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-03-15T13:08:07.734Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>CY</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä»åƒµå°¸æ¸¸æˆå­¦Solidity</title>
    <link href="http://example.com/2021/03/15/%E4%BB%8E%E5%83%B5%E5%B0%B8%E6%B8%B8%E6%88%8F%E5%AD%A6Solidity%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2021/03/15/%E4%BB%8E%E5%83%B5%E5%B0%B8%E6%B8%B8%E6%88%8F%E5%AD%A6Solidity%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2021-03-15T12:45:57.437Z</published>
    <updated>2021-03-15T13:08:07.734Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a class="markdownIt-Anchor" href="#å†™åœ¨å‰é¢"></a> å†™åœ¨å‰é¢</h1><p>å­¦ä¹ åœ°å€ï¼š<a href="https://cryptozombies.io/zh/course">https://cryptozombies.io/zh/course</a></p><p><strong>æ™ºèƒ½åè®®çš„æ°¸å›ºæ€§</strong><br />ï¼ˆå³ä»¥å¤ªåŠä¸Šçš„ DApp è·Ÿæ™®é€šçš„åº”ç”¨ç¨‹åºçš„åŒºåˆ«ï¼‰<br />åœ¨ä½ æŠŠæ™ºèƒ½åè®®ä¼ ä¸Šä»¥å¤ªåŠä¹‹åï¼Œå®ƒå°±å˜å¾—ä¸å¯æ›´æ”¹, è¿™ç§æ°¸å›ºæ€§æ„å‘³ç€ä½ çš„ä»£ç æ°¸è¿œä¸èƒ½è¢«è°ƒæ•´æˆ–æ›´æ–°ã€‚ä½ ç¼–è¯‘çš„ç¨‹åºä¼šä¸€ç›´ï¼Œæ°¸ä¹…çš„ï¼Œä¸å¯æ›´æ”¹çš„ï¼Œå­˜åœ¨ä»¥å¤ªåŠä¸Šã€‚è¿™å°±æ˜¯ Solidity ä»£ç çš„å®‰å…¨æ€§å¦‚æ­¤é‡è¦çš„ä¸€ä¸ªåŸå› ã€‚å¦‚æœä½ çš„æ™ºèƒ½åè®®æœ‰ä»»ä½•æ¼æ´ï¼Œå³ä½¿ä½ å‘ç°äº†ä¹Ÿæ— æ³•è¡¥æ•‘ã€‚ä½ åªèƒ½è®©ä½ çš„ç”¨æˆ·ä»¬æ”¾å¼ƒè¿™ä¸ªæ™ºèƒ½åè®®ï¼Œç„¶åè½¬ç§»åˆ°ä¸€ä¸ªæ–°çš„ä¿®å¤åçš„åˆçº¦ä¸Šã€‚<br />ä½†è¿™æ°å¥½ä¹Ÿæ˜¯æ™ºèƒ½åˆçº¦çš„ä¸€å¤§ä¼˜åŠ¿ã€‚ä»£ç è¯´æ˜ä¸€åˆ‡ã€‚å¦‚æœä½ å»è¯»æ™ºèƒ½åˆçº¦çš„ä»£ç ï¼Œå¹¶éªŒè¯å®ƒï¼Œä½ ä¼šå‘ç°ï¼Œä¸€æ—¦å‡½æ•°è¢«å®šä¹‰ä¸‹æ¥ï¼Œæ¯ä¸€æ¬¡çš„è¿è¡Œï¼Œç¨‹åºéƒ½ä¼šä¸¥æ ¼éµç…§å‡½æ•°ä¸­åŸæœ‰çš„ä»£ç é€»è¾‘ä¸€ä¸ä¸è‹Ÿåœ°æ‰§è¡Œï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒå‡½æ•°è¢«äººç¯¡æ”¹è€Œå¾—åˆ°æ„å¤–çš„ç»“æœã€‚</p><p><strong>Gas - é©±åŠ¨ä»¥å¤ªåŠDAppsçš„èƒ½æº</strong><br />åœ¨ Solidity ä¸­ï¼Œä½ çš„ç”¨æˆ·æƒ³è¦æ¯æ¬¡æ‰§è¡Œä½ çš„ DApp éƒ½éœ€è¦æ”¯ä»˜ä¸€å®šçš„ gasï¼Œgas å¯ä»¥ç”¨ä»¥å¤ªå¸è´­ä¹°ï¼Œå› æ­¤ï¼Œç”¨æˆ·æ¯æ¬¡è·‘ DApp éƒ½å¾—èŠ±è´¹ä»¥å¤ªå¸ã€‚</p><p>ä¸€ä¸ª DApp æ”¶å–å¤šå°‘ gas å–å†³äºåŠŸèƒ½é€»è¾‘çš„å¤æ‚ç¨‹åº¦ã€‚æ¯ä¸ªæ“ä½œèƒŒåï¼Œéƒ½åœ¨è®¡ç®—å®Œæˆè¿™ä¸ªæ“ä½œæ‰€éœ€è¦çš„è®¡ç®—èµ„æºï¼Œï¼ˆæ¯”å¦‚ï¼Œå­˜å‚¨æ•°æ®å°±æ¯”åšä¸ªåŠ æ³•è¿ç®—è´µå¾—å¤šï¼‰ï¼Œ ä¸€æ¬¡æ“ä½œæ‰€éœ€è¦èŠ±è´¹çš„ gas ç­‰äºè¿™ä¸ªæ“ä½œèƒŒåçš„æ‰€æœ‰è¿ç®—èŠ±é”€çš„æ€»å’Œã€‚<br /><em>çœ gas çš„æ‹›æ•°ï¼šç»“æ„å°è£… ï¼ˆStruct packingï¼‰</em><br />é™¤äº†åŸºæœ¬ç‰ˆçš„ uint å¤–ï¼Œè¿˜æœ‰å…¶ä»–å˜ç§ uintï¼šuint8ï¼Œuint16ï¼Œuint32ç­‰ã€‚<br />é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸ä¼šè€ƒè™‘ä½¿ç”¨ uint å˜ç§ï¼Œå› ä¸ºæ— è®ºå¦‚ä½•å®šä¹‰ uintçš„å¤§å°ï¼ŒSolidity ä¸ºå®ƒä¿ç•™256ä½çš„å­˜å‚¨ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ uint8 è€Œä¸æ˜¯uintï¼ˆuint256ï¼‰ä¸ä¼šä¸ºä½ èŠ‚çœä»»ä½• gasã€‚</p><p>é™¤éï¼ŒæŠŠ uint ç»‘å®šåˆ° struct é‡Œé¢ã€‚<br />å¦‚æœä¸€ä¸ª struct ä¸­æœ‰å¤šä¸ª uintï¼Œåˆ™å°½å¯èƒ½ä½¿ç”¨è¾ƒå°çš„ uint, Solidity ä¼šå°†è¿™äº› uint æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œä»è€Œå ç”¨è¾ƒå°‘çš„å­˜å‚¨ç©ºé—´ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">struct NormalStruct &#123;</span><br><span class="line">  uint a;</span><br><span class="line">  uint b;</span><br><span class="line">  uint c;</span><br><span class="line">&#125;</span><br><span class="line">struct MiniMe &#123;</span><br><span class="line">  uint32 a;</span><br><span class="line">  uint32 b;</span><br><span class="line">  uint c;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; å› ä¸ºä½¿ç”¨äº†ç»“æ„æ‰“åŒ…ï¼Œ&#96;mini&#96; æ¯” &#96;normal&#96; å ç”¨çš„ç©ºé—´æ›´å°‘</span><br><span class="line">NormalStruct normal &#x3D; NormalStruct(10, 20, 30);</span><br><span class="line">MiniMe mini &#x3D; MiniMe(10, 20, 30); </span><br></pre></td></tr></table></figure><p><em>â€œviewâ€ å‡½æ•°ä¸èŠ± â€œgasâ€</em><br />è¿™æ˜¯å› ä¸º view å‡½æ•°ä¸ä¼šçœŸæ­£æ”¹å˜åŒºå—é“¾ä¸Šçš„ä»»ä½•æ•°æ® - å®ƒä»¬åªæ˜¯è¯»å–ã€‚å› æ­¤ç”¨ view æ ‡è®°ä¸€ä¸ªå‡½æ•°ï¼Œæ„å‘³ç€å‘Šè¯‰ web3.jsï¼Œè¿è¡Œè¿™ä¸ªå‡½æ•°åªéœ€è¦æŸ¥è¯¢ä½ çš„æœ¬åœ°ä»¥å¤ªåŠèŠ‚ç‚¹ï¼Œè€Œä¸éœ€è¦åœ¨åŒºå—é“¾ä¸Šåˆ›å»ºä¸€ä¸ªäº‹åŠ¡ï¼ˆäº‹åŠ¡éœ€è¦è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› æ­¤èŠ±è´¹ gasï¼‰ã€‚<br />æ³¨æ„ï¼š<em>å¦‚æœä¸€ä¸ª view å‡½æ•°åœ¨å¦ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨è¢«è°ƒç”¨ï¼Œè€Œè°ƒç”¨å‡½æ•°ä¸ view å‡½æ•°çš„ä¸å±äºåŒä¸€ä¸ªåˆçº¦ï¼Œä¹Ÿä¼šäº§ç”Ÿè°ƒç”¨æˆæœ¬ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœä¸»è°ƒå‡½æ•°åœ¨ä»¥å¤ªåŠåˆ›å»ºäº†ä¸€ä¸ªäº‹åŠ¡ï¼Œå®ƒä»ç„¶éœ€è¦é€ä¸ªèŠ‚ç‚¹å»éªŒè¯ã€‚æ‰€ä»¥æ ‡è®°ä¸º view çš„å‡½æ•°åªæœ‰åœ¨å¤–éƒ¨è°ƒç”¨æ—¶æ‰æ˜¯å…è´¹çš„ã€‚</em></p><p><strong>ä½¿ç”¨ SafeMathé¢„é˜²æº¢å‡º</strong><br />ä¸ºäº†é˜²æ­¢è¿™äº›æƒ…å†µï¼ŒOpenZeppelin å»ºç«‹äº†ä¸€ä¸ªå«åš SafeMath çš„ <em>åº“</em>(library)ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯ä»¥é˜²æ­¢è¿™äº›é—®é¢˜ã€‚<br />ä¸€ä¸ª_åº“_ æ˜¯ Solidity ä¸­ä¸€ç§ç‰¹æ®Šçš„åˆçº¦ã€‚å…¶ä¸­ä¸€ä¸ªæœ‰ç”¨çš„åŠŸèƒ½æ˜¯ç»™åŸå§‹æ•°æ®ç±»å‹å¢åŠ ä¸€äº›æ–¹æ³•ã€‚<br />æ¯”å¦‚ï¼Œä½¿ç”¨ SafeMath åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ using SafeMath for uint256 è¿™æ ·çš„è¯­æ³•ã€‚ SafeMath åº“æœ‰å››ä¸ªæ–¹æ³• â€” addï¼Œ subï¼Œ mulï¼Œ ä»¥åŠ divã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥è®© uint256 è°ƒç”¨è¿™äº›æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">using SafeMath for uint256;</span><br><span class="line"></span><br><span class="line">uint256 a &#x3D; 5;</span><br><span class="line">uint256 b &#x3D; a.add(3); &#x2F;&#x2F; 5 + 3 &#x3D; 8</span><br><span class="line">uint256 c &#x3D; a.mul(2); &#x2F;&#x2F; 5 * 2 &#x3D; 10</span><br></pre></td></tr></table></figure><h1 id="sodility"><a class="markdownIt-Anchor" href="#sodility"></a> Sodility</h1><h2 id="åˆçº¦"><a class="markdownIt-Anchor" href="#åˆçº¦"></a> åˆçº¦</h2><p>ä¸€ä»½åˆçº¦å°±æ˜¯ä»¥å¤ªåº”å¸åº”ç”¨çš„åŸºæœ¬æ¨¡å—ï¼Œæ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°éƒ½å±äºä¸€ä»½åˆçº¦, å®ƒæ˜¯æ‰€æœ‰åº”ç”¨çš„èµ·ç‚¹.</p><p><strong>ç‰ˆæœ¬æŒ‡ä»¤</strong>ï¼šæ‰€æœ‰çš„ Solidity æºç éƒ½å¿…é¡»å† ä»¥*â€œversion pragmaâ€* â€” æ ‡æ˜ Solidity ç¼–è¯‘å™¨çš„ç‰ˆæœ¬. ä»¥é¿å…å°†æ¥æ–°çš„ç¼–è¯‘å™¨å¯èƒ½ç ´åä½ çš„ä»£ç ã€‚<em>ï¼ˆetc. pragma solidity ^0.4.19;)</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.19;</span><br><span class="line">contract ZombieFactory &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>OpenZeppelinåº“çš„Ownable åˆçº¦</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @title Ownable</span><br><span class="line"> * @dev The Ownable contract has an owner address, and provides basic authorization control</span><br><span class="line"> * functions, this simplifies the implementation of &quot;user permissions&quot;.</span><br><span class="line"> *&#x2F;</span><br><span class="line">contract Ownable &#123;</span><br><span class="line">  address public owner;</span><br><span class="line">  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);</span><br><span class="line"></span><br><span class="line">  &#x2F;**</span><br><span class="line">   * @dev The Ownable constructor sets the original &#96;owner&#96; of the contract to the sender</span><br><span class="line">   * account.</span><br><span class="line">   *&#x2F;</span><br><span class="line">  function Ownable() public &#123;</span><br><span class="line">    owner &#x3D; msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;**</span><br><span class="line">   * @dev Throws if called by any account other than the owner.</span><br><span class="line">   *&#x2F;</span><br><span class="line">  modifier onlyOwner() &#123;</span><br><span class="line">    require(msg.sender &#x3D;&#x3D; owner);</span><br><span class="line">    _;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;**</span><br><span class="line">   * @dev Allows the current owner to transfer control of the contract to a newOwner.</span><br><span class="line">   * @param newOwner The address to transfer ownership to.</span><br><span class="line">   *&#x2F;</span><br><span class="line">  function transferOwnership(address newOwner) public onlyOwner &#123;</span><br><span class="line">    require(newOwner !&#x3D; address(0));</span><br><span class="line">    OwnershipTransferred(owner, newOwner);</span><br><span class="line">    owner &#x3D; newOwner;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€æ„é€ å‡½æ•°ï¼šfunction Ownable()æ˜¯ä¸€ä¸ª _ constructor_ (æ„é€ å‡½æ•°)ï¼Œæ„é€ å‡½æ•°ä¸æ˜¯å¿…é¡»çš„ï¼Œå®ƒä¸åˆçº¦åŒåï¼Œæ„é€ å‡½æ•°ä¸€ç”Ÿä¸­å”¯ä¸€çš„ä¸€æ¬¡æ‰§è¡Œï¼Œå°±æ˜¯åœ¨åˆçº¦æœ€åˆè¢«åˆ›å»ºçš„æ—¶å€™ã€‚<br />2ã€å‡½æ•°ä¿®é¥°ç¬¦ï¼šmodifier onlyOwner()ã€‚ ä¿®é¥°ç¬¦è·Ÿå‡½æ•°å¾ˆç±»ä¼¼ï¼Œä¸è¿‡æ˜¯ç”¨æ¥ä¿®é¥°å…¶ä»–å·²æœ‰å‡½æ•°ç”¨çš„ï¼Œ åœ¨å…¶ä»–è¯­å¥æ‰§è¡Œå‰ï¼Œä¸ºå®ƒæ£€æŸ¥ä¸‹å…ˆéªŒæ¡ä»¶ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™ä¸ªä¿®é¥°ç¬¦ onlyOwner æ£€æŸ¥ä¸‹è°ƒç”¨è€…ï¼Œç¡®ä¿åªæœ‰åˆçº¦çš„ä¸»äººæ‰èƒ½è¿è¡Œæœ¬å‡½æ•°ã€‚<br />3ã€indexed å…³é”®å­—ï¼š</p><h2 id="æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#æ•°æ®ç±»å‹"></a> æ•°æ®ç±»å‹</h2><p><strong>çŠ¶æ€å˜é‡</strong><br />çŠ¶æ€å˜é‡æ˜¯è¢«<em>æ°¸ä¹…</em>åœ°ä¿å­˜åœ¨åˆçº¦ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒä»¬è¢«å†™å…¥ä»¥å¤ªå¸åŒºå—é“¾ä¸­. æƒ³è±¡æˆå†™å…¥ä¸€ä¸ªæ•°æ®åº“ã€‚</p><p><strong>æ— ç¬¦å·æ•´æ•°</strong><br />uint å…¶å€¼ä¸èƒ½æ˜¯è´Ÿæ•°ï¼Œå¯¹äºæœ‰ç¬¦å·çš„æ•´æ•°å­˜åœ¨åä¸º int çš„æ•°æ®ç±»å‹ã€‚<em>æ³¨: Solidityä¸­ï¼Œ uint å®é™…ä¸Šæ˜¯ uint256ä»£åè¯ï¼Œ ä¸€ä¸ª256ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä½æ•°å°‘çš„uints â€” uint8ï¼Œ uint16ï¼Œ uint32</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uint dnaDigits &#x3D; 16;</span><br><span class="line">uint dnaModulus &#x3D; 10 ** dnaDigits;</span><br></pre></td></tr></table></figure><p><strong>ç»“æ„ä½“</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">struct Person &#123;</span><br><span class="line">  uint age;</span><br><span class="line">  string name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•°ç»„</strong><br />Solidity æ”¯æŒä¸¤ç§æ•°ç»„: <em>é™æ€ æ•°ç»„å’ŒåŠ¨æ€ æ•°ç»„</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å›ºå®šé•¿åº¦ä¸º2çš„é™æ€æ•°ç»„:</span><br><span class="line">uint[2] fixedArray;</span><br><span class="line">&#x2F;&#x2F; å›ºå®šé•¿åº¦ä¸º5çš„stringç±»å‹çš„é™æ€æ•°ç»„:</span><br><span class="line">string[5] stringArray;</span><br><span class="line">&#x2F;&#x2F; åŠ¨æ€æ•°ç»„ï¼Œé•¿åº¦ä¸å›ºå®šï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ å…ƒç´ :</span><br><span class="line">uint[] dynamicArray;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ªç»“æ„ä½“ç±»å‹çš„æ•°ç»„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Person[] people; &#x2F;&#x2F; è¿™æ˜¯åŠ¨æ€æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­æ·»åŠ å…ƒç´ </span><br><span class="line">&#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–°çš„Person:</span><br><span class="line">Person satoshi &#x3D; Person(172, &quot;Satoshi&quot;);</span><br><span class="line">&#x2F;&#x2F; å°†æ–°åˆ›å»ºçš„satoshiæ·»åŠ è¿›peopleæ•°ç»„:</span><br><span class="line">people.push(satoshi);</span><br><span class="line">&#x2F;&#x2F;ä¹Ÿå¯ä»¥å°†ä¸¤æ­¥åˆå¹¶</span><br><span class="line">people.push(Person(16, &quot;Vitalik&quot;));</span><br><span class="line">&#x2F;&#x2F;array.push() åœ¨æ•°ç»„çš„å°¾éƒ¨åŠ å…¥æ–°å…ƒç´ ï¼Œæ‰€ä»¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„é¡ºåºå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„é¡ºåº</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<br />çŠ¶æ€å˜é‡è¢«æ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸­ã€‚æ‰€ä»¥åœ¨ä½ çš„åˆçº¦ä¸­åˆ›å»ºåŠ¨æ€æ•°ç»„æ¥ä¿å­˜æˆç»“æ„çš„æ•°æ®æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚</p><p><strong>å…¬å…±æ•°ç»„</strong><br />å®šä¹‰ <em>public</em> æ•°ç»„, Solidity ä¼šè‡ªåŠ¨åˆ›å»º <em>getter</em> æ–¹æ³•. è¯­æ³•å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Zombie[] public zombies;</span><br></pre></td></tr></table></figure><p>å…¶å®ƒçš„åˆçº¦å¯ä»¥ä»è¿™ä¸ªæ•°ç»„è¯»å–æ•°æ®ï¼ˆä½†ä¸èƒ½å†™å…¥æ•°æ®ï¼‰ï¼Œæ‰€ä»¥è¿™åœ¨åˆçº¦ä¸­æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿å­˜å…¬å…±æ•°æ®çš„æ¨¡å¼ã€‚</p><p><strong>æ˜ å°„ï¼ˆMappingï¼‰å’Œåœ°å€ï¼ˆAddressï¼‰</strong><br /><em>Addressesï¼ˆåœ°å€ï¼‰</em><br />ä»¥å¤ªåŠåŒºå—é“¾ç”± _ account _ (è´¦æˆ·)ç»„æˆï¼Œä¸€ä¸ªå¸æˆ·çš„ä½™é¢æ˜¯ <em>ä»¥å¤ª</em> ï¼ˆåœ¨ä»¥å¤ªåŠåŒºå—é“¾ä¸Šä½¿ç”¨çš„å¸ç§ï¼‰ï¼Œä½ å¯ä»¥å’Œå…¶ä»–å¸æˆ·ä¹‹é—´æ”¯ä»˜å’Œæ¥å—ä»¥å¤ªå¸ï¼Œå°±åƒé“¶è¡Œå¸æˆ·å¯ä»¥ç”µæ±‡èµ„é‡‘åˆ°å…¶ä»–é“¶è¡Œå¸æˆ·ä¸€æ ·ã€‚<br />åœ¨ Solidity ä¸­ï¼Œæœ‰ä¸€äº›å…¨å±€å˜é‡å¯ä»¥è¢«æ‰€æœ‰å‡½æ•°è°ƒç”¨ã€‚ å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ <em>msg.sender</em>ï¼Œå®ƒæŒ‡çš„æ˜¯å½“å‰è°ƒç”¨è€…ï¼ˆæˆ–æ™ºèƒ½åˆçº¦ï¼‰çš„ addressã€‚<br /><em>Mappingï¼ˆæ˜ å°„ï¼‰</em><br />æ˜ å°„æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨å’ŒæŸ¥æ‰¾æ•°æ®æ‰€ç”¨çš„é”®-å€¼å¯¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping (uint &#x3D;&gt; address) public zombieToOwner;</span><br><span class="line">mapping (address &#x3D;&gt; uint) ownerZombieCount;</span><br></pre></td></tr></table></figure><p><strong>Storageä¸Memory</strong><br />åœ¨ Solidity ä¸­ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥å­˜å‚¨å˜é‡ â€”â€” storage æˆ– memoryã€‚<br /><em>Storage</em> å˜é‡æ˜¯æŒ‡æ°¸ä¹…å­˜å‚¨åœ¨åŒºå—é“¾ä¸­çš„å˜é‡ã€‚<br /><em>Memory</em>å˜é‡åˆ™æ˜¯ä¸´æ—¶çš„ï¼Œå½“å¤–éƒ¨å‡½æ•°å¯¹æŸåˆçº¦è°ƒç”¨å®Œæˆæ—¶ï¼Œå†…å­˜å‹å˜é‡å³è¢«ç§»é™¤ã€‚ ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå­˜å‚¨åœ¨ä½ ç”µè„‘çš„ç¡¬ç›˜æˆ–æ˜¯RAMä¸­æ•°æ®çš„å…³ç³»ã€‚<br />é»˜è®¤æƒ…å†µä¸‹ Solidity ä¼šè‡ªåŠ¨å¤„ç†å®ƒä»¬ã€‚ çŠ¶æ€å˜é‡ï¼ˆåœ¨å‡½æ•°ä¹‹å¤–å£°æ˜çš„å˜é‡ï¼‰é»˜è®¤ä¸ºâ€œå­˜å‚¨â€å½¢å¼ï¼Œå¹¶æ°¸ä¹…å†™å…¥åŒºå—é“¾ï¼›è€Œåœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡æ˜¯â€œå†…å­˜â€å‹çš„ï¼Œå®ƒä»¬å‡½æ•°è°ƒç”¨ç»“æŸåæ¶ˆå¤±ã€‚<br />ç„¶è€Œä¹Ÿæœ‰ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦æ‰‹åŠ¨å£°æ˜å­˜å‚¨ç±»å‹ï¼Œä¸»è¦ç”¨äºå¤„ç†å‡½æ•°å†…çš„ _ ç»“æ„ä½“ _ å’Œ _ æ•°ç»„ _ æ—¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Sandwich[] sandwiches;</span><br><span class="line">function eatSandwich(uint _index) public &#123;</span><br><span class="line">  &#x2F;&#x2F; Sandwich mySandwich &#x3D; sandwiches[_index];</span><br><span class="line">  &#x2F;&#x2F; ^ çœ‹ä¸Šå»å¾ˆç›´æ¥ï¼Œä¸è¿‡ Solidity å°†ä¼šç»™å‡ºè­¦å‘Š</span><br><span class="line">  &#x2F;&#x2F; å‘Šè¯‰ä½ åº”è¯¥æ˜ç¡®åœ¨è¿™é‡Œå®šä¹‰ &#96;storage&#96; æˆ–è€… &#96;memory&#96;ã€‚</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; æ‰€ä»¥ä½ åº”è¯¥æ˜ç¡®å®šä¹‰ &#96;storage&#96;:</span><br><span class="line">  Sandwich storage mySandwich &#x3D; sandwiches[_index];</span><br><span class="line">  &#x2F;&#x2F; ...è¿™æ · &#96;mySandwich&#96; æ˜¯æŒ‡å‘ &#96;sandwiches[_index]&#96;çš„æŒ‡é’ˆ</span><br><span class="line">  &#x2F;&#x2F; åœ¨å­˜å‚¨é‡Œï¼Œå¦å¤–...</span><br><span class="line">  mySandwich.status &#x3D; &quot;Eaten!&quot;;</span><br><span class="line">  &#x2F;&#x2F; ...è¿™å°†æ°¸ä¹…æŠŠ &#96;sandwiches[_index]&#96; å˜ä¸ºåŒºå—é“¾ä¸Šçš„å­˜å‚¨</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; å¦‚æœä½ åªæƒ³è¦ä¸€ä¸ªå‰¯æœ¬ï¼Œå¯ä»¥ä½¿ç”¨&#96;memory&#96;:</span><br><span class="line">  Sandwich memory anotherSandwich &#x3D; sandwiches[_index + 1];</span><br><span class="line">  &#x2F;&#x2F; ...è¿™æ · &#96;anotherSandwich&#96; å°±ä»…ä»…æ˜¯ä¸€ä¸ªå†…å­˜é‡Œçš„å‰¯æœ¬äº†</span><br><span class="line">  &#x2F;&#x2F; å¦å¤–</span><br><span class="line">  anotherSandwich.status &#x3D; &quot;Eaten!&quot;;</span><br><span class="line">  &#x2F;&#x2F; ...å°†ä»…ä»…ä¿®æ”¹ä¸´æ—¶å˜é‡ï¼Œå¯¹ &#96;sandwiches[_index + 1]&#96; æ²¡æœ‰ä»»ä½•å½±å“</span><br><span class="line">  &#x2F;&#x2F; ä¸è¿‡ä½ å¯ä»¥è¿™æ ·åš:</span><br><span class="line">  sandwiches[_index + 1] &#x3D; anotherSandwich;</span><br><span class="line">  &#x2F;&#x2F; ...å¦‚æœä½ æƒ³æŠŠå‰¯æœ¬çš„æ”¹åŠ¨ä¿å­˜å›åŒºå—é“¾å­˜å‚¨</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Keccak256 å’Œ ç±»å‹è½¬æ¢</strong><br />Ethereum å†…éƒ¨æœ‰ä¸€ä¸ªæ•£åˆ—å‡½æ•°keccak256ï¼Œå®ƒç”¨äº†SHA3ç‰ˆæœ¬ã€‚ä¸€ä¸ªæ•£åˆ—å‡½æ•°åŸºæœ¬ä¸Šå°±æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ª256ä½çš„16è¿›åˆ¶æ•°å­—ã€‚å­—ç¬¦ä¸²çš„ä¸€ä¸ªå¾®å°å˜åŒ–ä¼šå¼•èµ·æ•£åˆ—æ•°æ®æå¤§å˜åŒ–ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uint rand &#x3D; uint(keccak256(_str));</span><br></pre></td></tr></table></figure><p><strong>æ—¶é—´å•ä½</strong><br />å˜é‡ now å°†è¿”å›å½“å‰çš„unixæ—¶é—´æˆ³ï¼ˆè‡ª1970å¹´1æœˆ1æ—¥ä»¥æ¥ç»è¿‡çš„ç§’æ•°ï¼‰ã€‚<br />Solidity è¿˜åŒ…å«ç§’(seconds)ï¼Œåˆ†é’Ÿ(minutes)ï¼Œå°æ—¶(hours)ï¼Œå¤©(days)ï¼Œå‘¨(weeks) å’Œ å¹´(years) ç­‰æ—¶é—´å•ä½ã€‚å®ƒä»¬éƒ½ä¼šè½¬æ¢æˆå¯¹åº”çš„ç§’æ•°æ”¾å…¥ uint ä¸­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">uint lastUpdated;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å°†â€˜ä¸Šæ¬¡æ›´æ–°æ—¶é—´â€™ è®¾ç½®ä¸º â€˜ç°åœ¨â€™</span><br><span class="line">function updateTimestamp() public &#123;</span><br><span class="line">  lastUpdated &#x3D; now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å¦‚æœåˆ°ä¸Šæ¬¡&#96;updateTimestamp&#96; è¶…è¿‡5åˆ†é’Ÿï¼Œè¿”å› &#39;true&#39;</span><br><span class="line">&#x2F;&#x2F; ä¸åˆ°5åˆ†é’Ÿè¿”å› &#39;false&#39;</span><br><span class="line">function fiveMinutesHavePassed() public view returns (bool) &#123;</span><br><span class="line">  return (now &gt;&#x3D; (lastUpdated + 5 minutes));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°"><a class="markdownIt-Anchor" href="#å‡½æ•°"></a> å‡½æ•°</h2><p>åœ¨ Solidity ä¸­å‡½æ•°å®šä¹‰çš„å¥æ³•å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function createZombie(string _name, uint _dna) &#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š <em>ä¹ æƒ¯ä¸Šå‡½æ•°é‡Œçš„å˜é‡éƒ½æ˜¯ä»¥(_)å¼€å¤´ (ä½†ä¸æ˜¯ç¡¬æ€§è§„å®š) ä»¥åŒºåˆ«å…¨å±€å˜é‡ã€‚</em></p><p><mark>require</mark>ä½¿å¾—å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä¸æ»¡è¶³æŸäº›æ¡ä»¶æ—¶æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åœæ­¢æ‰§è¡Œã€‚åœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¹‹å‰ï¼Œç”¨ require éªŒè¯å‰ç½®æ¡ä»¶æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">require(ownerZombieCount[msg.sender] &#x3D;&#x3D; 0);</span><br></pre></td></tr></table></figure><p><strong>å…¬æœ‰/ç§æœ‰å‡½æ•°</strong><br />Solidity å®šä¹‰çš„å‡½æ•°çš„å±æ€§é»˜è®¤ä¸º<em>å…¬å…±</em>ã€‚ è¿™å°±æ„å‘³ç€ä»»ä½•ä¸€æ–¹ (æˆ–å…¶å®ƒåˆçº¦) éƒ½å¯ä»¥è°ƒç”¨ä½ åˆçº¦é‡Œçš„å‡½æ•°ã€‚<br />å°†è‡ªå·±çš„å‡½æ•°å®šä¹‰ä¸º<em>ç§æœ‰</em>æ˜¯ä¸€ä¸ªå¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œåªæœ‰å½“ä½ éœ€è¦å¤–éƒ¨ä¸–ç•Œè°ƒç”¨å®ƒæ—¶æ‰å°†å®ƒè®¾ç½®ä¸ºå…¬å…±ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function _createZombie(string _name, uint _dna) private &#123;</span><br><span class="line">        zombies.push(Zombie(_name, _dna));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ„å‘³ç€åªæœ‰æˆ‘ä»¬åˆçº¦ä¸­çš„å…¶å®ƒå‡½æ•°æ‰èƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªå‡½æ•°,å’Œå‡½æ•°çš„å‚æ•°ç±»ä¼¼ï¼Œç§æœ‰å‡½æ•°çš„åå­—ç”¨(_)èµ·å§‹ã€‚</p><p><strong>å‡½æ•°çš„ä¿®é¥°ç¬¦</strong><br />1ã€<em>å¯è§æ€§ä¿®é¥°ç¬¦</em>:ï¼šå†³å®šå‡½æ•°ä½•æ—¶å’Œè¢«è°è°ƒç”¨ï¼šprivate æ„å‘³ç€å®ƒåªèƒ½è¢«åˆçº¦å†…éƒ¨è°ƒç”¨ï¼› internal å°±åƒ private ä½†æ˜¯ä¹Ÿèƒ½è¢«ç»§æ‰¿çš„åˆçº¦è°ƒç”¨ï¼› external åªèƒ½ä»åˆçº¦å¤–éƒ¨è°ƒç”¨ï¼›æœ€å public å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ï¼Œä¸ç®¡æ˜¯å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚<br />2ã€<em>çŠ¶æ€ä¿®é¥°ç¬¦</em>ï¼šå†³å®šå‡½æ•°å¦‚ä½•å’ŒåŒºå—é“¾äº¤äº’: view å‘Šè¯‰æˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‡½æ•°ä¸ä¼šæ›´æ”¹å’Œä¿å­˜ä»»ä½•æ•°æ®ï¼› pure å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå‡½æ•°ä¸ä½†ä¸ä¼šå¾€åŒºå—é“¾å†™æ•°æ®ï¼Œå®ƒç”šè‡³ä¸ä»åŒºå—é“¾è¯»å–æ•°æ®ã€‚è¿™ä¸¤ç§åœ¨è¢«ä»åˆçº¦å¤–éƒ¨è°ƒç”¨çš„æ—¶å€™éƒ½ä¸èŠ±è´¹ä»»ä½•gasï¼ˆä½†æ˜¯å®ƒä»¬åœ¨è¢«å†…éƒ¨å…¶ä»–å‡½æ•°è°ƒç”¨çš„æ—¶å€™å°†ä¼šè€—è´¹gasï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;view</span><br><span class="line">function sayHello() public view returns (string) </span><br><span class="line">&#x2F;&#x2F;pure</span><br><span class="line">function _multiply(uint a, uint b) private pure returns (uint) &#123;</span><br><span class="line">  return a * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€<em>è‡ªå®šä¹‰çš„ modifier</em>ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å…¶å¯¹å‡½æ•°çš„çº¦æŸé€»è¾‘ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å­˜å‚¨ç”¨æˆ·å¹´é¾„çš„æ˜ å°„</span><br><span class="line">mapping (uint &#x3D;&gt; uint) public age;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; é™å®šç”¨æˆ·å¹´é¾„çš„ä¿®é¥°ç¬¦</span><br><span class="line">modifier olderThan(uint _age, uint _userId) &#123;</span><br><span class="line">  require(age[_userId] &gt;&#x3D; _age);</span><br><span class="line">  _;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å¿…é¡»å¹´æ»¡16å‘¨å²æ‰å…è®¸å¼€è½¦ (è‡³å°‘åœ¨ç¾å›½æ˜¯è¿™æ ·çš„).</span><br><span class="line">&#x2F;&#x2F; æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹å‚æ•°è°ƒç”¨&#96;olderThan&#96; ä¿®é¥°ç¬¦:</span><br><span class="line">function driveCar(uint _userId) public olderThan(16, _userId) &#123;</span><br><span class="line">  &#x2F;&#x2F; å…¶ä½™çš„ç¨‹åºé€»è¾‘</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€payable ä¿®é¥°ç¬¦<br />payableæ–¹æ³•æ˜¯è®© Solidity å’Œä»¥å¤ªåŠå˜å¾—å¦‚æ­¤é…·çš„ä¸€éƒ¨åˆ† â€”â€” å®ƒä»¬æ˜¯ä¸€ç§å¯ä»¥æ¥æ”¶ä»¥å¤ªçš„ç‰¹æ®Šå‡½æ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">contract OnlineStore &#123;</span><br><span class="line">  function buySomething() external payable &#123;</span><br><span class="line">    &#x2F;&#x2F; æ£€æŸ¥ä»¥ç¡®å®š0.001ä»¥å¤ªå‘é€å‡ºå»æ¥è¿è¡Œå‡½æ•°:</span><br><span class="line">    require(msg.value &#x3D;&#x3D; 0.001 ether);</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœä¸ºçœŸï¼Œä¸€äº›ç”¨æ¥å‘å‡½æ•°è°ƒç”¨è€…å‘é€æ•°å­—å†…å®¹çš„é€»è¾‘</span><br><span class="line">    transferThing(msg.sender);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œmsg.value æ˜¯ä¸€ç§å¯ä»¥æŸ¥çœ‹å‘åˆçº¦å‘é€äº†å¤šå°‘ä»¥å¤ªçš„æ–¹æ³•ï¼Œå¦å¤– ether æ˜¯ä¸€ä¸ªå…§å»ºå•å…ƒã€‚</p><p>è¿™é‡Œå‘ç”Ÿçš„äº‹æ˜¯ï¼Œä¸€äº›äººä¼šä» web3.js è°ƒç”¨è¿™ä¸ªå‡½æ•° (ä»DAppçš„å‰ç«¯)ï¼Œ åƒè¿™æ · :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å‡è®¾ &#96;OnlineStore&#96; åœ¨ä»¥å¤ªåŠä¸ŠæŒ‡å‘ä½ çš„åˆçº¦:</span><br><span class="line">OnlineStore.buySomething().send(from: web3.eth.defaultAccount, value: web3.utils.toWei(0.001))</span><br></pre></td></tr></table></figure><p><em>æç°</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">contract GetPaid is Ownable &#123;</span><br><span class="line">  function withdraw() external onlyOwner &#123;</span><br><span class="line">    owner.transfer(this.balance);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ transfer å‡½æ•°å‘ä¸€ä¸ªåœ°å€å‘é€ä»¥å¤ªï¼Œ ç„¶å this.balance å°†è¿”å›å½“å‰åˆçº¦å­˜å‚¨äº†å¤šå°‘ä»¥å¤ªã€‚</p><p><strong>è¿”å›å€¼</strong><br /><em>å•ä¸ªè¿”å›å€¼</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function _generateRandomDna(string _str) private returns (uint) &#123;</span><br><span class="line">        &#x2F;&#x2F; è¿™é‡Œå¼€å§‹</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><em>å¤šä¸ªè¿”å›å€¼</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function multipleReturns() internal returns(uint a, uint b, uint c) &#123;</span><br><span class="line">  return (1, 2, 3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function processMultipleReturns() external &#123;</span><br><span class="line">  uint a;</span><br><span class="line">  uint b;</span><br><span class="line">  uint c;</span><br><span class="line">  &#x2F;&#x2F; è¿™æ ·æ¥åšæ‰¹é‡èµ‹å€¼:</span><br><span class="line">  (a, b, c) &#x3D; multipleReturns();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æˆ–è€…å¦‚æœæˆ‘ä»¬åªæƒ³è¿”å›å…¶ä¸­ä¸€ä¸ªå˜é‡:</span><br><span class="line">function getLastReturnValue() external &#123;</span><br><span class="line">  uint c;</span><br><span class="line">  &#x2F;&#x2F; å¯ä»¥å¯¹å…¶ä»–å­—æ®µç•™ç©º:</span><br><span class="line">  (,,c) &#x3D; multipleReturns();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»§æ‰¿ï¼ˆInheritanceï¼‰å’Œå¼•å…¥ï¼ˆImportï¼‰</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &quot;.&#x2F;zombiefactory.sol&quot;;</span><br><span class="line">contract ZombieFeeding is ZombieFactory &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å®ç°å¤šç»§æ‰¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">contract ZombieOwnership is ZombieAttack, ERC721 &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>For å¾ªç¯</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function getEvens() pure external returns(uint[]) &#123;</span><br><span class="line">  uint[] memory evens &#x3D; new uint[](5);</span><br><span class="line">  &#x2F;&#x2F; åœ¨æ–°æ•°ç»„ä¸­è®°å½•åºåˆ—å·</span><br><span class="line">  uint counter &#x3D; 0;</span><br><span class="line">  &#x2F;&#x2F; åœ¨å¾ªç¯ä»1è¿­ä»£åˆ°10ï¼š</span><br><span class="line">  for (uint i &#x3D; 1; i &lt;&#x3D; 10; i++) &#123;</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœ &#96;i&#96; æ˜¯å¶æ•°...</span><br><span class="line">    if (i % 2 &#x3D;&#x3D; 0) &#123;</span><br><span class="line">      &#x2F;&#x2F; æŠŠå®ƒåŠ å…¥å¶æ•°æ•°ç»„</span><br><span class="line">      evens[counter] &#x3D; i;</span><br><span class="line">      &#x2F;&#x2F;ç´¢å¼•åŠ ä¸€ï¼Œ æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºçš„â€˜evenâ€™</span><br><span class="line">      counter++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return evens;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº‹ä»¶"><a class="markdownIt-Anchor" href="#äº‹ä»¶"></a> äº‹ä»¶</h2><p><em>äº‹ä»¶</em>æ˜¯åˆçº¦å’ŒåŒºå—é“¾é€šè®¯çš„ä¸€ç§æœºåˆ¶ã€‚å‰ç«¯åº”ç”¨â€œç›‘å¬â€æŸäº›äº‹ä»¶ï¼Œå¹¶åšå‡ºååº”ã€‚</p><h2 id="ä¸å…¶ä»–åˆçº¦çš„äº¤äº’"><a class="markdownIt-Anchor" href="#ä¸å…¶ä»–åˆçº¦çš„äº¤äº’"></a> ä¸å…¶ä»–åˆçº¦çš„äº¤äº’</h2><p>å¦‚æœæˆ‘ä»¬çš„åˆçº¦éœ€è¦å’ŒåŒºå—é“¾ä¸Šçš„å…¶ä»–çš„åˆçº¦ä¼šè¯ï¼Œåˆ™éœ€å…ˆå®šä¹‰ä¸€ä¸ª interface (æ¥å£)ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">contract KittyInterface &#123;</span><br><span class="line">  function getKitty(uint256 _id) external view returns (</span><br><span class="line">    bool isGestating,</span><br><span class="line">    bool isReady,</span><br><span class="line">    uint256 cooldownIndex,</span><br><span class="line">    uint256 nextActionAt,</span><br><span class="line">    uint256 siringWithId,</span><br><span class="line">    uint256 birthTime,</span><br><span class="line">    uint256 matronId,</span><br><span class="line">    uint256 sireId,</span><br><span class="line">    uint256 generation,</span><br><span class="line">    uint256 genes</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹è™½ç„¶çœ‹èµ·æ¥åƒåœ¨å®šä¹‰ä¸€ä¸ªåˆçº¦ï¼Œä½†å…¶å®å†…é‡Œä¸åŒï¼š<br />é¦–å…ˆï¼Œæˆ‘ä»¬åªå£°æ˜äº†è¦ä¸ä¹‹äº¤äº’çš„å‡½æ•° ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åˆ°ä»»ä½•å…¶ä»–çš„å‡½æ•°æˆ–çŠ¶æ€å˜é‡ã€‚<br />å…¶æ¬¡ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·ï¼ˆ{ å’Œ }ï¼‰å®šä¹‰å‡½æ•°ä½“ï¼Œæˆ‘ä»¬å•å•ç”¨åˆ†å·ï¼ˆ;ï¼‰ç»“æŸäº†å‡½æ•°å£°æ˜ã€‚è¿™ä½¿å®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªåˆçº¦æ¡†æ¶ã€‚<br />ç¼–è¯‘å™¨å°±æ˜¯é è¿™äº›ç‰¹å¾è®¤å‡ºå®ƒæ˜¯ä¸€ä¸ªæ¥å£çš„ã€‚<br />åœ¨æˆ‘ä»¬çš„ app ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œåˆçº¦å°±çŸ¥é“å…¶ä»–åˆçº¦çš„å‡½æ•°æ˜¯æ€æ ·çš„ï¼Œåº”è¯¥å¦‚ä½•è°ƒç”¨ï¼Œä»¥åŠå¯æœŸå¾…ä»€ä¹ˆç±»å‹çš„è¿”å›å€¼ã€‚<br />åªè¦å°†åˆçº¦çš„å¯è§æ€§è®¾ç½®ä¸ºpublic(å…¬å…±)æˆ–external(å¤–éƒ¨)ï¼Œå®ƒä»¬å°±å¯ä»¥ä¸ä»¥å¤ªåŠåŒºå—é“¾ä¸Šçš„ä»»ä½•å…¶ä»–åˆçº¦è¿›è¡Œäº¤äº’ã€‚</p><h2 id="ä»¥å¤ªåŠä¸Šçš„ä»£å¸"><a class="markdownIt-Anchor" href="#ä»¥å¤ªåŠä¸Šçš„ä»£å¸"></a> ä»¥å¤ªåŠä¸Šçš„ä»£å¸</h2><p>ä¸€ä¸ª <em>ä»£å¸</em> åœ¨ä»¥å¤ªåŠåŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªéµå¾ªä¸€äº›å…±åŒè§„åˆ™çš„æ™ºèƒ½åˆçº¦â€”â€”å³å®ƒå®ç°äº†æ‰€æœ‰å…¶ä»–ä»£å¸åˆçº¦å…±äº«çš„ä¸€ç»„æ ‡å‡†å‡½æ•°ï¼Œä¾‹å¦‚ transfer(address _to, uint256 _value) å’Œ balanceOf(address _owner).<br />åœ¨æ™ºèƒ½åˆçº¦å†…éƒ¨ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªæ˜ å°„ï¼Œ mapping(address =&gt; uint256) balancesï¼Œç”¨äºè¿½è¸ªæ¯ä¸ªåœ°å€è¿˜æœ‰å¤šå°‘ä½™é¢ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šä¸€ä¸ªä»£å¸åªæ˜¯ä¸€ä¸ªè¿½è¸ªè°æ‹¥æœ‰å¤šå°‘è¯¥ä»£å¸çš„åˆçº¦ï¼Œå’Œä¸€äº›å¯ä»¥è®©é‚£äº›ç”¨æˆ·å°†ä»–ä»¬çš„ä»£å¸è½¬ç§»åˆ°å…¶ä»–åœ°å€çš„å‡½æ•°ã€‚<br />ä»£å¸æ ‡å‡†ï¼šERC20ã€ERC721ï¼ˆåŠ å¯†æ”¶è—å“ï¼‰<br /><em>ERC271</em>ä»£å¸æ˜¯ä¸èƒ½äº’æ¢çš„ï¼Œå› ä¸ºæ¯ä¸ªä»£å¸éƒ½è¢«è®¤ä¸ºæ˜¯å”¯ä¸€ä¸”ä¸å¯åˆ†å‰²çš„ã€‚ ä½ åªèƒ½ä»¥æ•´ä¸ªå•ä½äº¤æ˜“å®ƒä»¬ï¼Œå¹¶ä¸”æ¯ä¸ªå•ä½éƒ½æœ‰å”¯ä¸€çš„ IDã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">contract ERC721 &#123;</span><br><span class="line">  event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);</span><br><span class="line">  event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);</span><br><span class="line">  </span><br><span class="line">  function balanceOf(address _owner) public view returns (uint256 _balance);</span><br><span class="line">  function ownerOf(uint256 _tokenId) public view returns (address _owner);</span><br><span class="line">  function transfer(address _to, uint256 _tokenId) public;</span><br><span class="line">  function approve(address _to, uint256 _tokenId) public;</span><br><span class="line">  function takeOwnership(uint256 _tokenId) public;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ERC721: è½¬ç§»æ ‡å‡†</strong><br />ERC721 è§„èŒƒæœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•æ¥è½¬ç§»ä»£å¸ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transfer(address _to, uint256 _tokenId) public;</span><br><span class="line"></span><br><span class="line">function approve(address _to, uint256 _tokenId) public;</span><br><span class="line">function takeOwnership(uint256 _tokenId) public;</span><br></pre></td></tr></table></figure><p>1ã€ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä»£å¸çš„æ‹¥æœ‰è€…è°ƒç”¨transfer æ–¹æ³•ï¼Œä¼ å…¥ä»–æƒ³è½¬ç§»åˆ°çš„ address å’Œä»–æƒ³è½¬ç§»çš„ä»£å¸çš„ _tokenIdã€‚<br />2ã€ç¬¬äºŒç§æ–¹æ³•æ˜¯ä»£å¸æ‹¥æœ‰è€…é¦–å…ˆè°ƒç”¨ approveï¼Œç„¶åä¼ å…¥ä¸ä»¥ä¸Šç›¸åŒçš„å‚æ•°ã€‚æ¥ç€ï¼Œè¯¥åˆçº¦ä¼šå­˜å‚¨è°è¢«å…è®¸æå–ä»£å¸ï¼Œé€šå¸¸å­˜å‚¨åˆ°ä¸€ä¸ª mapping (uint256 =&gt; address) é‡Œã€‚ç„¶åï¼Œå½“æœ‰äººè°ƒç”¨ takeOwnership æ—¶ï¼Œåˆçº¦ä¼šæ£€æŸ¥ msg.sender æ˜¯å¦å¾—åˆ°æ‹¥æœ‰è€…çš„æ‰¹å‡†æ¥æå–ä»£å¸ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†ä»£å¸è½¬ç§»ç»™ä»–ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function _transfer(address _from, address _to, uint256 _tokenId) private &#123;</span><br><span class="line">    ownerZombieCount[_to]++;</span><br><span class="line">    ownerZombieCount[_from]--;</span><br><span class="line">    zombieToOwner[_tokenId] &#x3D; _to;</span><br><span class="line">    Transfer(_from, _to, _tokenId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function transfer(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) &#123;</span><br><span class="line">    _transfer(msg.sender, _to, _tokenId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function approve(address _to, uint256 _tokenId) public onlyOwnerOf(_tokenId) &#123;</span><br><span class="line">    zombieApprovals[_tokenId] &#x3D; _to;</span><br><span class="line">    Approval(msg.sender, _to, _tokenId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function takeOwnership(uint256 _tokenId) public &#123;</span><br><span class="line">    require(zombieApprovals[_tokenId] &#x3D;&#x3D; msg.sender);</span><br><span class="line">    address owner &#x3D; ownerOf(_tokenId);</span><br><span class="line">    _transfer(owner, msg.sender, _tokenId);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="åº”ç”¨å‰ç«¯å’Œ-web3js"><a class="markdownIt-Anchor" href="#åº”ç”¨å‰ç«¯å’Œ-web3js"></a> åº”ç”¨å‰ç«¯å’Œ Web3.js</h1><p><strong>ä»€ä¹ˆæ˜¯ Web3.js?</strong><br />ä»¥å¤ªåŠç½‘ç»œæ˜¯ç”±èŠ‚ç‚¹ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«äº†åŒºå—é“¾çš„ä¸€ä»½æ‹·è´ã€‚å½“ä½ æƒ³è¦è°ƒç”¨ä¸€ä»½æ™ºèƒ½åˆçº¦çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½ éœ€è¦ä»å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸­æŸ¥æ‰¾å¹¶å‘Šè¯‰å®ƒ:æ™ºèƒ½åˆçº¦çš„åœ°å€ã€ä½ æƒ³è°ƒç”¨çš„æ–¹æ³•ï¼Œä»¥åŠä½ æƒ³ä¼ å…¥é‚£ä¸ªæ–¹æ³•çš„å‚æ•°ã€‚ä»¥å¤ªåŠèŠ‚ç‚¹åªèƒ½è¯†åˆ«ä¸€ç§å«åš JSON-RPC çš„è¯­è¨€ã€‚è¿™ç§è¯­è¨€ç›´æ¥è¯»èµ·æ¥å¹¶ä¸å¥½æ‡‚ã€‚<br />å¹¸è¿çš„æ˜¯ Web3.js æŠŠè¿™äº›ä»¤äººè®¨åŒçš„æŸ¥è¯¢è¯­å¥éƒ½éšè—èµ·æ¥äº†ï¼Œ æ‰€ä»¥ä½ åªéœ€è¦ä¸æ–¹ä¾¿æ˜“æ‡‚çš„ JavaScript ç•Œé¢è¿›è¡Œäº¤äº’å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CryptoZombies.methods.createRandomZombie(&quot;Vitalik Nakamoto ğŸ¤”&quot;)</span><br><span class="line">  .send(&#123; from: &quot;0xb60e8dd61c5d32be8058bb8eb970870f07233155&quot;, gas: &quot;3000000&quot; &#125;)</span><br></pre></td></tr></table></figure><p><strong>æ·»åŠ Web3.jså·¥å…·</strong><br />å¯ä»¥ä» github ç›´æ¥ä¸‹è½½å‹ç¼©åçš„ .js æ–‡ä»¶ ç„¶ååŒ…å«åˆ°é¡¹ç›®æ–‡ä»¶ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;javascript&quot; type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;web3.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p><strong>Web3 Provider</strong><br />ä»¥å¤ªåŠæ˜¯ç”±å…±äº«åŒä¸€ä»½æ•°æ®çš„ç›¸åŒæ‹·è´çš„ <em>èŠ‚ç‚¹</em> æ„æˆçš„ã€‚ åœ¨ Web3.js é‡Œè®¾ç½® Web3 çš„ Providerï¼ˆæä¾›è€…ï¼‰ å‘Šè¯‰æˆ‘ä»¬çš„ä»£ç åº”è¯¥å’Œ å“ªä¸ªèŠ‚ç‚¹ äº¤äº’æ¥å¤„ç†æˆ‘ä»¬çš„è¯»å†™ã€‚è¿™å°±å¥½åƒåœ¨ä¼ ç»Ÿçš„ Web åº”ç”¨ç¨‹åºä¸­ä¸ºä½ çš„ API è°ƒç”¨è®¾ç½®è¿œç¨‹ Web æœåŠ¡å™¨çš„ç½‘å€ã€‚</p><p><strong>Infura</strong><br />Infura æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œå®ƒç»´æŠ¤äº†å¾ˆå¤šä»¥å¤ªåŠèŠ‚ç‚¹å¹¶æä¾›äº†ä¸€ä¸ªç¼“å­˜å±‚æ¥å®ç°é«˜é€Ÿè¯»å–ã€‚ä½ å¯ä»¥ç”¨ä»–ä»¬çš„ API æ¥å…è´¹è®¿é—®è¿™ä¸ªæœåŠ¡ã€‚ ç”¨ Infura ä½œä¸ºèŠ‚ç‚¹æä¾›è€…ï¼Œä½ å¯ä»¥ä¸ç”¨è‡ªå·±è¿è¥èŠ‚ç‚¹å°±èƒ½å¾ˆå¯é åœ°å‘ä»¥å¤ªåŠå‘é€ã€æ¥æ”¶ä¿¡æ¯ã€‚<br />ä½ å¯ä»¥é€šè¿‡è¿™æ ·æŠŠ Infura ä½œä¸ºä½ çš„ Web3 èŠ‚ç‚¹æä¾›è€…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var web3 &#x3D; new Web3(new Web3.providers.WebsocketProvider(&quot;wss:&#x2F;&#x2F;mainnet.infura.io&#x2F;ws&quot;));</span><br></pre></td></tr></table></figure><p><strong>Metamask</strong><br />Metamask æ˜¯ Chrome å’Œ Firefox çš„æµè§ˆå™¨æ‰©å±•ï¼Œ å®ƒèƒ½è®©ç”¨æˆ·å®‰å…¨åœ°ç»´æŠ¤ä»–ä»¬çš„ä»¥å¤ªåŠè´¦æˆ·å’Œç§é’¥ï¼Œ å¹¶ç”¨ä»–ä»¬çš„è´¦æˆ·å’Œä½¿ç”¨ Web3.js çš„ç½‘ç«™äº’åŠ¨ã€‚Metamask é»˜è®¤ä½¿ç”¨ Infura çš„æœåŠ¡å™¨åšä¸º web3 æä¾›è€…ã€‚<br /><em>ä½¿ç”¨ Metamask çš„ web3 æä¾›è€…</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;load&#39;, function() &#123;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; æ£€æŸ¥web3æ˜¯å¦å·²ç»æ³¨å…¥åˆ°(Mist&#x2F;MetaMask)</span><br><span class="line">  if (typeof web3 !&#x3D;&#x3D; &#39;undefined&#39;) &#123;</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨ Mist&#x2F;MetaMask çš„æä¾›è€…</span><br><span class="line">    web3js &#x3D; new Web3(web3.currentProvider);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    &#x2F;&#x2F; å¤„ç†ç”¨æˆ·æ²¡å®‰è£…çš„æƒ…å†µï¼Œ æ¯”å¦‚æ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯</span><br><span class="line">    &#x2F;&#x2F; å‘Šè¯‰ä»–ä»¬è¦å®‰è£… MetaMask æ¥ä½¿ç”¨æˆ‘ä»¬çš„åº”ç”¨</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; ç°åœ¨ä½ å¯ä»¥å¯åŠ¨ä½ çš„åº”ç”¨å¹¶è‡ªç”±è®¿é—® Web3.js:</span><br><span class="line">  startApp()</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>ä¸åˆçº¦å¯¹è¯</strong><br />Web3.js éœ€è¦ä¸¤ä¸ªä¸œè¥¿æ¥å’Œä½ çš„åˆçº¦å¯¹è¯: å®ƒçš„<em>åœ°å€</em>å’Œå®ƒçš„ <em>ABI</em>ã€‚<br /><em>åœ°å€</em>ï¼šåœ¨ä½ éƒ¨ç½²æ™ºèƒ½åˆçº¦ä»¥åï¼Œå®ƒå°†è·å¾—ä¸€ä¸ªä»¥å¤ªåŠä¸Šçš„æ°¸ä¹…åœ°å€ã€‚<br /><em>ABI</em>å½“ä½ ç¼–è¯‘ä½ çš„åˆçº¦å‘ä»¥å¤ªåŠéƒ¨ç½²æ—¶(æˆ‘ä»¬å°†åœ¨ç¬¬ä¸ƒè¯¾è¯¦è¿°)ï¼Œ Solidity ç¼–è¯‘å™¨ä¼šç»™ä½  ABIã€‚å°†ç¼–è¯‘äº†çš„ABI å¹¶æ”¾åœ¨åä¸ºcryptozombies_abi.jsæ–‡ä»¶ä¸­ï¼Œä¿å­˜åœ¨ä¸€ä¸ªåä¸º cryptoZombiesABI çš„å˜é‡ä¸­ã€‚å°†cryptozombies_abi.js åŒ…å«è¿›æˆ‘ä»¬çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡é‚£ä¸ªå˜é‡è®¿é—® CryptoZombies ABI ã€‚<br /><em>å®ä¾‹åŒ– Web3.js</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å®ä¾‹åŒ– myContract</span><br><span class="line">var myContract &#x3D; new web3js.eth.Contract(myABI, myContractAddress);</span><br></pre></td></tr></table></figure><p><strong>è°ƒç”¨å’Œåˆçº¦å‡½æ•°</strong><br />Web3.js æœ‰ä¸¤ä¸ªæ–¹æ³•æ¥è°ƒç”¨æˆ‘ä»¬åˆçº¦çš„å‡½æ•°: call and send.<br /><em>Call</em><br />call ç”¨æ¥è°ƒç”¨ view å’Œ pure å‡½æ•°ã€‚å®ƒåªè¿è¡Œåœ¨æœ¬åœ°èŠ‚ç‚¹ï¼Œä¸ä¼šåœ¨åŒºå—é“¾ä¸Šåˆ›å»ºäº‹åŠ¡ã€‚ï¼ˆview å’Œ pure å‡½æ•°æ˜¯åªè¯»çš„å¹¶ä¸ä¼šæ”¹å˜åŒºå—é“¾çš„çŠ¶æ€ã€‚å®ƒä»¬ä¹Ÿä¸ä¼šæ¶ˆè€—ä»»ä½•gasã€‚ç”¨æˆ·ä¹Ÿä¸ä¼šè¢«è¦æ±‚ç”¨MetaMaskå¯¹äº‹åŠ¡ç­¾åã€‚ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function getZombieDetails(id) &#123;</span><br><span class="line">  return cryptoZombies.methods.zombies(id).call()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è°ƒç”¨å‡½æ•°å¹¶åšä¸€äº›å…¶ä»–äº‹æƒ…</span><br><span class="line">getZombieDetails(15)</span><br><span class="line">.then(function(result) &#123;</span><br><span class="line">  console.log(&quot;Zombie 15: &quot; + JSON.stringify(result));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>cryptoZombies.methods.zombies(id).call() å°†å’Œ Web3 æä¾›è€…èŠ‚ç‚¹é€šä¿¡ï¼Œå‘Šè¯‰å®ƒè¿”å›ä»æˆ‘ä»¬çš„åˆçº¦ä¸­çš„ Zombie[] public zombiesï¼Œidä¸ºä¼ å…¥å‚æ•°çš„åƒµå°¸ä¿¡æ¯ã€‚<br />æ³¨æ„è¿™æ˜¯ å¼‚æ­¥çš„ï¼Œå°±åƒä»å¤–éƒ¨æœåŠ¡å™¨ä¸­è°ƒç”¨APIã€‚æ‰€ä»¥ Web3 åœ¨è¿™é‡Œè¿”å›äº†ä¸€ä¸ª Promises. (å¦‚æœä½ å¯¹ JavaScriptçš„ Promises ä¸äº†è§£ï¼Œæœ€å¥½å…ˆå»å­¦ä¹ ä¸€ä¸‹è¿™æ–¹é¢çŸ¥è¯†å†ç»§ç»­)ã€‚<br />ä¸€æ—¦é‚£ä¸ª promise è¢« resolve, (æ„å‘³ç€æˆ‘ä»¬ä» Web3 æä¾›è€…é‚£é‡Œè·å¾—äº†å“åº”)ï¼Œæˆ‘ä»¬çš„ä¾‹å­ä»£ç å°†æ‰§è¡Œ then è¯­å¥ä¸­çš„ä»£ç ï¼Œåœ¨æ§åˆ¶å°æ‰“å‡º resultã€‚</p><p><em>è·å¾— MetaMaskä¸­çš„ç”¨æˆ·è´¦æˆ·</em><br />MetaMask å…è®¸ç”¨æˆ·åœ¨æ‰©å±•ä¸­ç®¡ç†å¤šä¸ªè´¦æˆ·ã€‚<br />æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·æ¥è·å– web3 å˜é‡ä¸­æ¿€æ´»çš„å½“å‰è´¦æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var userAccount &#x3D; web3.eth.accounts[0]</span><br></pre></td></tr></table></figure><p>å› ä¸ºç”¨æˆ·å¯ä»¥éšæ—¶åœ¨ MetaMask ä¸­åˆ‡æ¢è´¦æˆ·ï¼Œæˆ‘ä»¬çš„åº”ç”¨éœ€è¦ç›‘æ§è¿™ä¸ªå˜é‡ï¼Œä¸€æ—¦æ”¹å˜å°±è¦ç›¸åº”æ›´æ–°ç•Œé¢ã€‚ä¾‹å¦‚ï¼Œè‹¥ç”¨æˆ·çš„é¦–é¡µå±•ç¤ºå®ƒä»¬çš„åƒµå°¸å¤§å†›ï¼Œå½“ä»–ä»¬åœ¨ MetaMask ä¸­åˆ‡æ¢äº†è´¦å·ï¼Œæˆ‘ä»¬å°±éœ€è¦æ›´æ–°é¡µé¢æ¥å±•ç¤ºæ–°é€‰æ‹©çš„è´¦æˆ·çš„åƒµå°¸å¤§å†›ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ setInterval æ–¹æ³•æ¥åš:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var accountInterval &#x3D; setInterval(function() &#123;</span><br><span class="line">          &#x2F;&#x2F; Check if account has changed</span><br><span class="line">          if (web3.eth.accounts[0] !&#x3D;&#x3D; userAccount) &#123;</span><br><span class="line">            userAccount &#x3D; web3.eth.accounts[0];</span><br><span class="line">            &#x2F;&#x2F; Call a function to update the UI with the new account</span><br><span class="line">            getZombiesByOwner(userAccount)</span><br><span class="line">            .then(displayZombies);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, 100);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç åšçš„æ˜¯ï¼Œæ¯100æ¯«ç§’æ£€æŸ¥ä¸€æ¬¡ userAccount æ˜¯å¦è¿˜ç­‰äº web3.eth.accounts[0] (æ¯”å¦‚ï¼šç”¨æˆ·æ˜¯å¦è¿˜æ¿€æ´»äº†é‚£ä¸ªè´¦æˆ·)ã€‚è‹¥ä¸ç­‰ï¼Œåˆ™å°† å½“å‰æ¿€æ´»ç”¨æˆ·èµ‹å€¼ç»™ userAccountï¼Œç„¶åè°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥æ›´æ–°ç•Œé¢ã€‚</p><p><em>Send</em><br />send å°†åˆ›å»ºä¸€ä¸ªäº‹åŠ¡å¹¶æ”¹å˜åŒºå—é“¾ä¸Šçš„æ•°æ®ã€‚ä½ éœ€è¦ç”¨ send æ¥è°ƒç”¨ä»»ä½•é view æˆ–è€… pure çš„å‡½æ•°ã€‚ï¼ˆsend ä¸€ä¸ªäº‹åŠ¡å°†è¦æ±‚ç”¨æˆ·æ”¯ä»˜gasï¼Œå¹¶ä¼šè¦æ±‚å¼¹å‡ºå¯¹è¯æ¡†è¯·æ±‚ç”¨æˆ·ä½¿ç”¨ Metamask å¯¹äº‹åŠ¡ç­¾åã€‚åœ¨æˆ‘ä»¬ä½¿ç”¨ Metamask ä½œä¸ºæˆ‘ä»¬çš„ web3 æä¾›è€…çš„æ—¶å€™ï¼Œæ‰€æœ‰è¿™ä¸€åˆ‡éƒ½ä¼šåœ¨æˆ‘ä»¬è°ƒç”¨ send() çš„æ—¶å€™è‡ªåŠ¨å‘ç”Ÿã€‚è€Œæˆ‘ä»¬è‡ªå·±æ— éœ€åœ¨ä»£ç ä¸­æ“å¿ƒè¿™ä¸€åˆ‡ã€‚ï¼‰</p><p>ç›¸å¯¹ call å‡½æ•°ï¼Œsend å‡½æ•°æœ‰å¦‚ä¸‹ä¸»è¦åŒºåˆ«:<br />1ã€send ä¸€ä¸ªäº‹åŠ¡éœ€è¦ä¸€ä¸ª from åœ°å€æ¥è¡¨æ˜è°åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯ä½  Solidity ä»£ç é‡Œçš„ msg.sender )ã€‚ æˆ‘ä»¬éœ€è¦è¿™æ˜¯æˆ‘ä»¬ DApp çš„ç”¨æˆ·ï¼Œè¿™æ ·ä¸€æ¥ MetaMask æ‰ä¼šå¼¹å‡ºæç¤ºè®©ä»–ä»¬å¯¹äº‹åŠ¡ç­¾åã€‚<br />2ã€send ä¸€ä¸ªäº‹åŠ¡å°†èŠ±è´¹ gas<br />3ã€åœ¨ç”¨æˆ· send ä¸€ä¸ªäº‹åŠ¡åˆ°è¯¥äº‹åŠ¡å¯¹åŒºå—é“¾äº§ç”Ÿå®é™…å½±å“ä¹‹é—´æœ‰ä¸€ä¸ªä¸å¯å¿½ç•¥çš„å»¶è¿Ÿã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å¿…é¡»ç­‰å¾…äº‹åŠ¡è¢«åŒ…å«è¿›ä¸€ä¸ªåŒºå—é‡Œï¼Œä»¥å¤ªåŠä¸Šä¸€ä¸ªåŒºå—çš„æ—¶é—´å¹³å‡ä¸‹æ¥æ˜¯15ç§’å·¦å³ã€‚å¦‚æœå½“å‰åœ¨ä»¥å¤ªåŠä¸Šæœ‰å¤§é‡æŒ‚èµ·äº‹åŠ¡æˆ–è€…ç”¨æˆ·å‘é€äº†è¿‡ä½çš„ gas ä»·æ ¼ï¼Œæˆ‘ä»¬çš„äº‹åŠ¡å¯èƒ½éœ€è¦ç­‰å¾…æ•°ä¸ªåŒºå—æ‰èƒ½è¢«åŒ…å«è¿›å»ï¼Œå¾€å¾€å¯èƒ½èŠ±è´¹æ•°åˆ†é’Ÿã€‚</p><p>æ‰€ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­æˆ‘ä»¬éœ€è¦ç¼–å†™é€»è¾‘æ¥å¤„ç†è¿™éƒ¨åˆ†å¼‚æ­¥ç‰¹æ€§ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function createRandomZombie(name) &#123;</span><br><span class="line">  &#x2F;&#x2F; è¿™å°†éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥åœ¨ç•Œé¢ä¸­å‘Šè¯‰ç”¨æˆ·è¿™ä¸€ç‚¹</span><br><span class="line">  &#x2F;&#x2F; äº‹åŠ¡è¢«å‘é€å‡ºå»äº†</span><br><span class="line">  $(&quot;#txStatus&quot;).text(&quot;æ­£åœ¨åŒºå—é“¾ä¸Šåˆ›å»ºåƒµå°¸ï¼Œè¿™å°†éœ€è¦ä¸€ä¼šå„¿...&quot;);</span><br><span class="line">  &#x2F;&#x2F; æŠŠäº‹åŠ¡å‘é€åˆ°æˆ‘ä»¬çš„åˆçº¦:</span><br><span class="line">  return cryptoZombies.methods.createRandomZombie(name)</span><br><span class="line">  .send(&#123; from: userAccount &#125;)</span><br><span class="line">  .on(&quot;receipt&quot;, function(receipt) &#123;</span><br><span class="line">    $(&quot;#txStatus&quot;).text(&quot;æˆåŠŸç”Ÿæˆäº† &quot; + name + &quot;!&quot;);</span><br><span class="line">    &#x2F;&#x2F; äº‹åŠ¡è¢«åŒºå—é“¾æ¥å—äº†ï¼Œé‡æ–°æ¸²æŸ“ç•Œé¢</span><br><span class="line">    getZombiesByOwner(userAccount).then(displayZombies);</span><br><span class="line">  &#125;)</span><br><span class="line">  .on(&quot;error&quot;, function(error) &#123;</span><br><span class="line">    &#x2F;&#x2F; å‘Šè¯‰ç”¨æˆ·åˆçº¦å¤±è´¥äº†</span><br><span class="line">    $(&quot;#txStatus&quot;).text(error);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>Web3.js ä¸­éœ€è¦ç‰¹æ®Šå¯¹å¾…çš„å‡½æ•° â€” payable å‡½æ•°ã€‚</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function levelUp(zombieId) &#123;</span><br><span class="line">        $(&quot;#txStatus&quot;).text(&quot;Leveling up your zombie...&quot;);</span><br><span class="line">        return cryptoZombies.methods.levelUp(zombieId)</span><br><span class="line">        .send(&#123; from: userAccount, value: web3.utils.toWei(&quot;0.001&quot;, &quot;ether&quot;) &#125;)</span><br><span class="line">        .on(&quot;receipt&quot;, function(receipt) &#123;</span><br><span class="line">          $(&quot;#txStatus&quot;).text(&quot;Power overwhelming! Zombie successfully leveled up&quot;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .on(&quot;error&quot;, function(error) &#123;</span><br><span class="line">          $(&quot;#txStatus&quot;).text(error);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><em>è®¢é˜…åˆçº¦äº‹ä»¶</em><br />åœ¨ Web3.jsé‡Œï¼Œ ä½ å¯ä»¥è®¢é˜… ä¸€ä¸ªäº‹ä»¶ï¼Œè¿™æ ·ä½ çš„ Web3 æä¾›è€…å¯ä»¥åœ¨æ¯æ¬¡äº‹ä»¶å‘ç”Ÿåè§¦å‘ä½ çš„ä¸€äº›ä»£ç é€»è¾‘ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cryptoZombies.events.NewZombie()</span><br><span class="line">.on(&quot;data&quot;, function(event) &#123;</span><br><span class="line">  let zombie &#x3D; event.returnValues;</span><br><span class="line">  console.log(&quot;ä¸€ä¸ªæ–°åƒµå°¸è¯ç”Ÿäº†ï¼&quot;, zombie.zombieId, zombie.name, zombie.dna);</span><br><span class="line">&#125;).on(&#39;error&#39;, console.error);</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™æ®µä»£ç å°†åœ¨ ä»»ä½• åƒµå°¸ç”Ÿæˆçš„æ—¶å€™æ¿€å‘ä¸€ä¸ªè­¦å‘Šä¿¡æ¯â€”â€”è€Œä¸ä»…ä»…æ˜¯å½“å‰ç”¨ç”¨æˆ·çš„åƒµå°¸ã€‚å¦‚æœæˆ‘ä»¬åªæƒ³å¯¹å½“å‰ç”¨æˆ·å‘å‡ºæé†’å‘¢ï¼Ÿ<br /><em>ä½¿ç”¨indexed</em><br />ä¸ºäº†ç­›é€‰ä»…å’Œå½“å‰ç”¨æˆ·ç›¸å…³çš„äº‹ä»¶ï¼Œæˆ‘ä»¬çš„ Solidity åˆçº¦å°†å¿…é¡»ä½¿ç”¨ indexed å…³é”®å­—ï¼Œå°±åƒæˆ‘ä»¬åœ¨ ERC721 å®ç°ä¸­çš„Transfer äº‹ä»¶ä¸­é‚£æ ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å› ä¸º_from å’Œ _to éƒ½æ˜¯ indexedï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å‰ç«¯äº‹ä»¶ç›‘å¬ä¸­è¿‡æ»¤äº‹ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cryptoZombies.events.Transfer(&#123; filter: &#123; _to: userAccount &#125; &#125;)</span><br><span class="line">.on(&quot;data&quot;, function(event) &#123;</span><br><span class="line">  let data &#x3D; event.returnValues;</span><br><span class="line">  &#x2F;&#x2F; å½“å‰ç”¨æˆ·æ›´æ–°äº†ä¸€ä¸ªåƒµå°¸ï¼æ›´æ–°ç•Œé¢æ¥æ˜¾ç¤º</span><br><span class="line">&#125;).on(&#39;error&#39;, console.error);</span><br></pre></td></tr></table></figure><p><em>æŸ¥è¯¢è¿‡å»çš„äº‹ä»¶</em><br />æˆ‘ä»¬ç”šè‡³å¯ä»¥ç”¨ getPastEvents æŸ¥è¯¢è¿‡å»çš„äº‹ä»¶ï¼Œå¹¶ç”¨è¿‡æ»¤å™¨ fromBlock å’Œ toBlock ç»™ Solidity ä¸€ä¸ªäº‹ä»¶æ—¥å¿—çš„æ—¶é—´èŒƒå›´(â€œblockâ€ åœ¨è¿™é‡Œä»£è¡¨ä»¥å¤ªåŠåŒºå—ç¼–å·ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cryptoZombies.getPastEvents(&quot;NewZombie&quot;, &#123; fromBlock: 0, toBlock: &#39;latest&#39; &#125;)</span><br><span class="line">.then(function(events) &#123;</span><br><span class="line">  &#x2F;&#x2F; events æ˜¯å¯ä»¥ç”¨æ¥éå†çš„ &#96;event&#96; å¯¹è±¡ </span><br><span class="line">  &#x2F;&#x2F; è¿™æ®µä»£ç å°†è¿”å›ç»™æˆ‘ä»¬ä»å¼€å§‹ä»¥æ¥åˆ›å»ºçš„åƒµå°¸åˆ—è¡¨</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å†™åœ¨å‰é¢&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å†™åœ¨å‰é¢&quot;&gt;&lt;/a&gt; å†™åœ¨å‰é¢&lt;/h1&gt;
&lt;p&gt;å­¦ä¹ åœ°å€ï¼š&lt;a href=&quot;https://cryptozombies.io/zh/course&quot;&gt;https://cryptozo</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2021/03/15/hello-world/"/>
    <id>http://example.com/2021/03/15/hello-world/</id>
    <published>2021-03-15T06:57:56.253Z</published>
    <updated>2021-03-15T06:57:56.253Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
